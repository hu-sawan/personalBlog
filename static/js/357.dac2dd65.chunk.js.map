{"version":3,"file":"static/js/357.dac2dd65.chunk.js","mappings":"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","sources":["data/firebase.js","components/mdEditor/MDEditor.js","pages/postForm/PostForm.js","pages/loginPage/LoginPage.js"],"sourcesContent":["import { initializeApp } from \"firebase/app\";\r\nimport { getStorage } from \"firebase/storage\";\r\nimport { getAuth } from \"firebase/auth\";\r\n\r\nconst firebaseConfig = {\r\n    apiKey: process.env.REACT_APP_FIREBSAE_API_KEY,\r\n    authDomain: process.env.REACT_APP_FIREBSAE_AUTH_DOMAIN,\r\n    projectId: process.env.REACT_APP_FIREBSAE_PROJECT_ID,\r\n    storageBucket: process.env.REACT_APP_FIREBSAE_STORAGE_BUCKET,\r\n    messagingSenderId: process.env.REACT_APP_FIREBSAE_MESSAGING_SENDER_ID,\r\n    appId: process.env.REACT_APP_FIREBSAE_APP_ID,\r\n};\r\n\r\nconst firebaseApp = initializeApp(firebaseConfig);\r\n\r\nexport const auth = getAuth(firebaseApp);\r\n\r\nexport const storage = getStorage(firebaseApp);\r\n","import React, { useMemo, useState } from \"react\";\r\nimport SimpleMdeReact from \"react-simplemde-editor\";\r\nimport \"easymde/dist/easymde.min.css\";\r\n\r\n// TODO: implement\r\nconst customMarkdownParser = () => {\r\n    return \"<strong>Currently working on this</strong>\";\r\n};\r\n\r\n// I used react-simplemde which is very eazy to use but the docs is not clear so I had to use other resources\r\n// to know how things work :)\r\nfunction MDEditor({ id, onChange, value }) {\r\n    const options = useMemo(() => {\r\n        return {\r\n            showIcons: [\"code\"],\r\n            hideIcons: [\"quote\", \"fullscreen\", \"image\", \"side-by-side\"],\r\n\r\n            previewRender: (plainText) => customMarkdownParser(plainText),\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <>\r\n            <SimpleMdeReact\r\n                id={id}\r\n                value={value}\r\n                onChange={onChange}\r\n                options={options}\r\n            />\r\n        </>\r\n    );\r\n}\r\n\r\nexport default MDEditor;\r\n","import \"./postForm.css\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { storage } from \"../../data/firebase\";\r\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\r\nimport MDEditor from \"../../components/mdEditor/MDEditor\";\r\nimport LoadPage from \"../../components/loadPage/LoadPage\";\r\n\r\n// will be used as the id for the post\r\n// declared here in order to not get updated each time the state will change\r\nconst postid = nanoid();\r\n\r\nfunction PostForm() {\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    // to handle errors more efficiently\r\n    const [error, setError] = useState(\"\");\r\n\r\n    // will restructure in the backend and add time\r\n    const [formData, setFormData] = useState({\r\n        _id: postid,\r\n        title: \"\",\r\n        content: \"\",\r\n        author: \"\",\r\n        facebook: \"\",\r\n        linkedin: \"\",\r\n        youtube: \"\",\r\n        imageUrl: \"\",\r\n    });\r\n    // used to prevent sending the data to the backend on mount since we only want to send it when\r\n    // the image is uploaded to the storage and we get the link\r\n    const isMounted = useRef(false);\r\n\r\n    // send the image to the cloud storage and return the link\r\n    const sendImageToStorage = async (field) => {\r\n        const file = field?.files[0];\r\n\r\n        // if no file was submitted\r\n        if (!file) {\r\n            setError(\"Image was not submitted!\");\r\n            return;\r\n        }\r\n\r\n        // get the file extension, type is in the form of image/png or any other type\r\n        const typeArray = file.type.split(\"/\");\r\n        const fileExtentsion = typeArray[typeArray.length - 1];\r\n\r\n        // create a reference to the storage\r\n        const storageRef = ref(storage, `posts/${postid}.${fileExtentsion}`);\r\n\r\n        setLoading(true);\r\n\r\n        const snapshot = await uploadBytes(storageRef, file);\r\n        const downloadURL = await getDownloadURL(snapshot.ref);\r\n\r\n        if (!downloadURL) {\r\n            setError(\"Image was not uploaded!\");\r\n            return;\r\n        }\r\n\r\n        return downloadURL;\r\n    };\r\n\r\n    const handleImage = async (field) => {\r\n        try {\r\n            const downloadURL = await sendImageToStorage(field);\r\n\r\n            if (!downloadURL) return;\r\n\r\n            setFormData((prevData) => {\r\n                return {\r\n                    ...prevData,\r\n                    imageUrl: downloadURL,\r\n                };\r\n            });\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n    };\r\n\r\n    const sendDataToApi = async () => {\r\n        try {\r\n            const res = await fetch(\"http://localhost:3001/api/addPost\", {\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\",\r\n                },\r\n                body: JSON.stringify(formData),\r\n            });\r\n            if (res.ok) console.log(\"post sent successfully\");\r\n            setLoading(false);\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        const sendData = async () => {\r\n            await sendDataToApi();\r\n\r\n            // only reload the page if there is no error\r\n            if (!error) {\r\n                window.location.reload();\r\n            }\r\n        };\r\n        if (isMounted.current) {\r\n            sendData();\r\n        } else {\r\n            isMounted.current = true;\r\n        }\r\n    }, [formData.imageUrl]);\r\n\r\n    /**\r\n     * problems I faced and how I solved them:\r\n     * since the proccess of uploading the image to the storage is async I faced a weired behaviour from the setter of\r\n     * the formData which is that that I was not able to force the handleImage function to wait for the setFormData to finish\r\n     * updating the state and then send the data to the api because the setFormData is async and I can't use await with it\r\n     * and because of that the api request was sent before the state was updated and the imageUrl was still empty.\r\n     *\r\n     * how I solved it:\r\n     * I updated handle submit to only handle the image uploading proccess and then I created a new function called sendDataToApi\r\n     * which I used useEffect to call it after the imageUrl is updated and then I used the isMounted ref to prevent sending the data\r\n     * to the api on mount else it will send the data twice on the first time will be empty and the second time will be with the imageUrl.\r\n     * */\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setError(\"\");\r\n\r\n        /**\r\n         * I can target the index directly but this appraoch will allow changing\r\n         * the order of the file input in the form\r\n         * */\r\n        for (const child of e.target)\r\n            if (child.type === \"file\") await handleImage(child);\r\n\r\n        /*\r\n            TODO: Try to find a way to reset the form after submitting the data without the need to reload the page\r\n            ! FIX: check if this is working\r\n            ! it is leading to uncosistency between the id assigned to the image name in the \r\n            ! starage and the id assigned to the document after being sent to the database\r\n        setFormData({\r\n            _id: nanoid(),\r\n            title: \"\",\r\n            content: \"\",\r\n            author: \"\",\r\n            facebook: \"\",\r\n            linkedin: \"\",\r\n            youtube: \"\",\r\n            imageUrl: \"\",\r\n        }); */\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        setFormData((prevData) => {\r\n            return {\r\n                ...prevData,\r\n                [e.target.name]: e.target.value,\r\n            };\r\n        });\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {loading && <LoadPage isActive={loading} />}\r\n            <div className=\"post-form-section\">\r\n                <div className=\"container\">\r\n                    <h2>Add Post</h2>\r\n                    {error && <div className=\"alert\">{error}</div>}\r\n                    <form onSubmit={handleSubmit}>\r\n                        <input\r\n                            value={formData.title}\r\n                            type=\"text\"\r\n                            name=\"title\"\r\n                            placeholder=\"Enter post title\"\r\n                            onChange={handleChange}\r\n                        />\r\n                        <input\r\n                            value={formData.author}\r\n                            type=\"text\"\r\n                            name=\"author\"\r\n                            placeholder=\"Enter your name\"\r\n                            onChange={handleChange}\r\n                        />\r\n                        <input\r\n                            value={formData.facebook}\r\n                            type=\"text\"\r\n                            name=\"facebook\"\r\n                            placeholder=\"Enter facebook url\"\r\n                            onChange={handleChange}\r\n                        />\r\n                        <input\r\n                            value={formData.linkedin}\r\n                            type=\"text\"\r\n                            name=\"linkedin\"\r\n                            placeholder=\"Enter linkedin url\"\r\n                            onChange={handleChange}\r\n                        />\r\n                        <input\r\n                            value={formData.youtube}\r\n                            type=\"text\"\r\n                            name=\"youtube\"\r\n                            placeholder=\"Enter youtube url\"\r\n                            onChange={handleChange}\r\n                        />\r\n                        {/* <textarea\r\n                            name=\"content\"\r\n                            placeholder=\"enter post content\"\r\n                            onChange={handleChange}\r\n                            value={formData.content}\r\n                        /> */}\r\n                        <MDEditor\r\n                            id=\"content-md\"\r\n                            onChange={(value) =>\r\n                                setFormData((prevData) => ({\r\n                                    ...prevData,\r\n                                    content: value,\r\n                                }))\r\n                            }\r\n                            value={formData.content}\r\n                        />\r\n                        <input type=\"file\" required={true} />\r\n                        <input type=\"submit\" />\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default PostForm;\r\n","import \"./loginPage.css\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport PostForm from \"../postForm/PostForm\";\r\nimport { auth } from \"../../data/firebase\";\r\nimport { signInWithEmailAndPassword, onAuthStateChanged } from \"firebase/auth\";\r\n\r\nfunction LoginPage() {\r\n    const [currentUser, setCurrentUser] = useState(null);\r\n    const [error, setError] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n    const [formData, setFormData] = useState({\r\n        email: \"\",\r\n        password: \"\",\r\n    });\r\n\r\n    const handleChange = (e) => {\r\n        setFormData((prevFormData) => ({\r\n            ...prevFormData,\r\n            [e.target.name]: e.target.value,\r\n        }));\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        try {\r\n            setError(\"\");\r\n            setLoading(true);\r\n            await signInWithEmailAndPassword(\r\n                auth,\r\n                formData.email,\r\n                formData.password\r\n            );\r\n        } catch {\r\n            setError(\"Failed to log in\");\r\n        }\r\n\r\n        setLoading(false);\r\n    };\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onAuthStateChanged(auth, (user) => {\r\n            setCurrentUser(user);\r\n        });\r\n\r\n        return unsubscribe;\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        setTimeout(() => {\r\n            setError(\"\");\r\n        }, 4000);\r\n    }, [error]);\r\n\r\n    if (currentUser) return <PostForm />;\r\n\r\n    return (\r\n        <div className=\"login-section container\">\r\n            <div className=\"form-card\">\r\n                <h2>Login</h2>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className={`alert ${error ? \"show\" : null}`}>\r\n                        {error}\r\n                    </div>\r\n                    <label htmlFor=\"email\">Email</label>\r\n                    <input\r\n                        name=\"email\"\r\n                        value={formData.email}\r\n                        onChange={handleChange}\r\n                        type=\"email\"\r\n                        className=\"form-control\"\r\n                        id=\"email\"\r\n                        placeholder=\"Email\"\r\n                    />\r\n                    <label htmlFor=\"password\">Password</label>\r\n                    <input\r\n                        name=\"password\"\r\n                        value={formData.password}\r\n                        onChange={handleChange}\r\n                        type=\"password\"\r\n                        className=\"form-control\"\r\n                        id=\"password\"\r\n                        placeholder=\"Password\"\r\n                    />\r\n                    <input\r\n                        type=\"submit\"\r\n                        className=\"submit-btn\"\r\n                        disabled={loading}\r\n                    />\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default LoginPage;\r\n"],"names":["firebaseApp","initializeApp","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","auth","getAuth","storage","getStorage","_ref","id","onChange","value","options","useMemo","showIcons","hideIcons","previewRender","plainText","_jsx","_Fragment","children","SimpleMdeReact","postid","nanoid","loading","setLoading","useState","error","setError","formData","setFormData","_id","title","content","author","facebook","linkedin","youtube","imageUrl","isMounted","useRef","handleImage","async","downloadURL","file","field","files","typeArray","type","split","fileExtentsion","length","storageRef","ref","concat","snapshot","uploadBytes","getDownloadURL","sendImageToStorage","prevData","e","console","log","useEffect","sendData","fetch","method","headers","body","JSON","stringify","ok","sendDataToApi","window","location","reload","current","handleChange","target","name","_jsxs","LoadPage","isActive","className","onSubmit","preventDefault","child","placeholder","MDEditor","required","currentUser","setCurrentUser","email","password","prevFormData","onAuthStateChanged","user","setTimeout","PostForm","signInWithEmailAndPassword","htmlFor","disabled"],"sourceRoot":""}